{
  "hash": "ae28e04c3de2a9e2f34dfb658635bcec",
  "result": {
    "markdown": "---\ntitle: \"E-commerce 데이터 분석 (1)\"\ndescription: |\n  UCI Machine Learning Repository: Online Retail Dataset\ndate: Sys.Date()\ncategories: [machine learning, statistics]\nimage: ecommerce.jpg\npreview-links: true\n---\n\n\n\n::: {.cell}\n<style type=\"text/css\">\npre code, pre, code {\n  <!-- white-space: pre !important; -->\n  overflow-x: scroll !important;\n  <!-- word-break: keep-all !important; -->\n  <!-- word-wrap: initial !important; -->\n}\n</style>\n:::\n\n\n본 포스팅은 패스트캠퍼스 [50개 프로젝트로 완벽하게 끝내는 머신러닝 시그니쳐](https://fastcampus.co.kr/data_online_msignature)의 강의내용을 바탕으로 참고하여 작성하였습니다.\n\n![문제해결 프로세스 7단계](seven-step-problem-solving-process.png){#fig-1}\n\n## 01. 문제해결 프로세스 기획{#sec-1}\n\n패스트캠퍼스 강의 중 박지환 강사님께서 준비 해주신 이커머스 데이터 분석 예제를 참고하여 진행하였습니다. 주어진 문제의 시나리오는 아래와 같습니다.\n\n:::{.callout-note icon=false}\n### 시나리오\n\nA사는 이커머스 플랫폼을 운영하고 있다. 해당 이커머스 플랫폼 서비스가 성장하기 위해서는 3가지 조건이 필요하다.\n\n① 신규고객 유입 ② 유입 고객 재구매 ③ 재구매고객 충성 고객화\n\n\nA사는 현재 '① 신규교객 유입 활동'은 마케팅 비용을 투자하여 적극 수행하고 있으나, '② 유입 고객 재구매'이 미미한 상황이다.\n충성고객의 Spending Power는 전체 매출에서 많은 비중을 차지하고 있으므로, 충성고객의 성장이 이어지지 않으면 플랫폼의 성장도 멈추게 되버린다.\n\n따라서 '② 유입 고객 재구매'를 촉진시킬 방법을 고민 중에 있는 상황이다.\n:::\n\n이 시나리오를 기반으로 문제해결 프로세스 @fig-1 에 따라 7가지 단계를 아래와 같이 정의할 수 있습니다. \n\n:::{.callout-note icon=false}\n### 문제해결 프로세스\n\n#### Step 1. 문제정의\n\n* 문제현상: 신규 고객 유입 후 재구매로 이어지는 고객의 감소\n* 예상 피해: `(재구매고객 → 충성고객)`의 부진으로 매출 성장 정체 및 신규고객 유입을 위한 마케팅 비용 증가로 인한 영업이익 감소\n\n#### Step 2. 기대효과 \n\n* 재구매 고객 증가 → 충성 고객 증가 → 매출 성장 → 영업 이익 증가\n* 선순환 체계 구축으로 인한 서비스 성장\n\n#### Step 3. 해결방안\n\n* ① EDA 및 일회성 데이터 분석을 통해 재구매 고객의 특성을 분석하고 이를 토대로 마케팅 기획\n* ② 재구매 가능성이 높은 고객을 예측하는 모델링 후 이를 활용한 타겟 마케팅 진행\n\n#### Step 4. 우선순위\n\n* ①번을 빠르게 수행 후 파일럿 테스트 진행 및 성과 측정\n* ①번의 효과가 좋지 않다면, ②번 진행 후 파일럿 테스트  재실행\n\n#### Step 5. 데이터 분석\n\n* 결정된 우선순위에 따라서 데이터 분석 및 모델링 진행\n\n#### Step 6. 성과측정\n\n* 최종 마케팅 후 성능을 평가하기 위한 지표 수립\n* 분석 및 모델링을 통해 추출한 타겟 고객군과 대조군을 설정하여 A/B 테스트 수행\n* A/B 테스트 결과 마케팅(재구매) 반응률 비교를 통해 통계적으로 유의미한지 검증: `t-test`\n* 유의미한 결과를 얻을 때까지 파일럿 테스트를 수정하며 진행\n\n#### Step 7. 모델 운영\n\n* 파일럿 테스트 후 결과가 유의미하다면 정규 마케팅으로 운영하기 위한 작업 준비\n* 모델을 실행을 위한 주기와 추출 타겟 고객군의 범위 결정\n* 정해진 주기에 따라 타겟 고객군의 추출을 자동화\n* 이를 마케팅 시스템과 연계하여 타겟 마케팅을 주기적으로 운영 및 평가\n:::\n\n현재 Step 1~4의 단계가 완료되어 **데이터 분석을 수행**해야 하는 단계라고 간주하겠습니다. \n\n## 02. Data Readiness Check & Sampling\n\n사용하고자 하는 데이터는 [UCI Machine Learning Repository](https://archive.ics.uci.edu/)에서 제공하는 [Online Retail](https://archive.ics.uci.edu/datasets?search=Online+Retail) 데이터를 사용해 진행했습니다. \n\n이 Online Retail 데이터를 A사에서 수집한 고객 거래 이력 데이터로 간주하고 해당 데이터에 대한 기본적인 전처리를 수행하겠습니다.\n\n### 02-01. Data Info Check\n\n주어진 데이터는 e-commerce 온라인 구매 데이터로 데이터 명세표는 아래와 같습니다.\n\n|`InvoiceNo`|`StockCode`|`Description`|`Quantity`|`InvoiceDate`|`UnitPrice`|`CustomerID`|`Country`|\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n|송장번호|재고코드|상세설명|수량|송장날짜|개당가격|고객ID|국가|\n|Categorical|Categorical|Categorical|Integer|Date|Continuous|Categorical|Categorical|\n\n이제 수집된 데이터의 기본적인 정보를 확인해 보겠습니다.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ndf <- read_csv(\"Online Retail.csv\", col_types = \"ccciTdcc\")\ndf %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 8\n  InvoiceNo StockCode Description                           Quantity InvoiceDate         UnitPrice CustomerID Country       \n  <chr>     <chr>     <chr>                                    <int> <dttm>                  <dbl> <chr>      <chr>         \n1 489434    85048     \"15CM CHRISTMAS GLASS BALL 20 LIGHTS\"       12 2009-12-01 07:45:00      6.95 13085      United Kingdom\n2 489434    79323P    \"PINK CHERRY LIGHTS\"                        12 2009-12-01 07:45:00      6.75 13085      United Kingdom\n3 489434    79323W    \"WHITE CHERRY LIGHTS\"                       12 2009-12-01 07:45:00      6.75 13085      United Kingdom\n4 489434    22041     \"RECORD FRAME 7\\\" SINGLE SIZE\"              48 2009-12-01 07:45:00      2.1  13085      United Kingdom\n5 489434    21232     \"STRAWBERRY CERAMIC TRINKET BOX\"            24 2009-12-01 07:45:00      1.25 13085      United Kingdom\n6 489434    22064     \"PINK DOUGHNUT TRINKET POT\"                 24 2009-12-01 07:45:00      1.65 13085      United Kingdom\n```\n:::\n:::\n\n#### **Data 크기 확인**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1,067,370 rows & 8 cols\ndf %>% dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1067370       8\n```\n:::\n:::\n\n\n#### **Data type 확인**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,067,370\nColumns: 8\n$ InvoiceNo   <chr> \"489434\", \"489434\", \"489434\", \"489434\", \"489434\", \"489434\", \"489434\", \"489434\", \"489435\", \"489435\", \"489435\", \"489435\", \"489436\", \"489436\", \"489436\", \"489436\", \"489436\", \"489436\"…\n$ StockCode   <chr> \"85048\", \"79323P\", \"79323W\", \"22041\", \"21232\", \"22064\", \"21871\", \"21523\", \"22350\", \"22349\", \"22195\", \"22353\", \"48173C\", \"21755\", \"21754\", \"84879\", \"22119\", \"22142\", \"22296\", \"222…\n$ Description <chr> \"15CM CHRISTMAS GLASS BALL 20 LIGHTS\", \"PINK CHERRY LIGHTS\", \"WHITE CHERRY LIGHTS\", \"RECORD FRAME 7\\\" SINGLE SIZE\", \"STRAWBERRY CERAMIC TRINKET BOX\", \"PINK DOUGHNUT TRINKET POT\",…\n$ Quantity    <int> 12, 12, 12, 48, 24, 24, 24, 10, 12, 12, 24, 12, 10, 18, 3, 16, 3, 12, 12, 12, 16, 4, 2, 12, 12, 12, 3, 6, 8, 8, 24, 6, 6, 12, 2, 1, 2, 2, 2, 3, 12, 12, 6, 3, 12, 12, 12, 12, 6, 6…\n$ InvoiceDate <dttm> 2009-12-01 07:45:00, 2009-12-01 07:45:00, 2009-12-01 07:45:00, 2009-12-01 07:45:00, 2009-12-01 07:45:00, 2009-12-01 07:45:00, 2009-12-01 07:45:00, 2009-12-01 07:45:00, 2009-12-0…\n$ UnitPrice   <dbl> 6.95, 6.75, 6.75, 2.10, 1.25, 1.65, 1.25, 5.95, 2.55, 3.75, 1.65, 2.55, 5.95, 5.45, 5.95, 1.69, 6.95, 1.45, 1.65, 1.65, 3.39, 3.75, 8.50, 4.65, 2.10, 2.10, 5.95, 2.95, 1.25, 1.25…\n$ CustomerID  <chr> \"13085\", \"13085\", \"13085\", \"13085\", \"13085\", \"13085\", \"13085\", \"13085\", \"13085\", \"13085\", \"13085\", \"13085\", \"13078\", \"13078\", \"13078\", \"13078\", \"13078\", \"13078\", \"13078\", \"13078\"…\n$ Country     <chr> \"United Kingdom\", \"United Kingdom\", \"United Kingdom\", \"United Kingdom\", \"United Kingdom\", \"United Kingdom\", \"United Kingdom\", \"United Kingdom\", \"United Kingdom\", \"United Kingdom\"…\n```\n:::\n:::\n\n\n#### **변수별 결측치 확인**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>% is.na() %>% colSums()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  InvoiceNo   StockCode Description    Quantity InvoiceDate   UnitPrice  CustomerID     Country \n          0           0        4382           0           0           0      243007           0 \n```\n:::\n:::\n\n\n고객 식별 정보인 `CustomerID` 같은 변수에 결측치가 있는 경우에는 추후에 해당 고객에 대한 정보를 알 수 없으므로 사전에 정보를 알 수 없는 불분명한 데이터로 취급하여 삭제하는 것이 좋습니다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df %>% drop_na(\"CustomerID\")\ndf %>% is.na() %>% colSums()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  InvoiceNo   StockCode Description    Quantity InvoiceDate   UnitPrice  CustomerID     Country \n          0           0           0           0           0           0           0           0 \n```\n:::\n:::\n\n\n#### **Outlier 확인**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>% \n  select_if(is.numeric) %>% \n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Quantity           UnitPrice       \n Min.   :-80995.00   Min.   :    0.00  \n 1st Qu.:     2.00   1st Qu.:    1.25  \n Median :     5.00   Median :    1.95  \n Mean   :    12.41   Mean   :    3.68  \n 3rd Qu.:    12.00   3rd Qu.:    3.75  \n Max.   : 80995.00   Max.   :38970.00  \n```\n:::\n:::\n\n\n구매 수량을 나타내는 `Quantity`는 음수 값을 가질 수 없으나, 반품 물품에 대한 값이 있으므로 확인 후 처리해야 합니다. 여기서는 `Quantity`가 음수인 값은 이상치(Outlier)라고 간주하고 삭제하겠습니다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Quantity가 음수인 데이터 확인 \n# 반품 및 회수 물량일 수도 있음\ndf %>% filter(Quantity < 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 18,744 × 8\n   InvoiceNo StockCode Description                       Quantity InvoiceDate         UnitPrice CustomerID Country       \n   <chr>     <chr>     <chr>                                <int> <dttm>                  <dbl> <chr>      <chr>         \n 1 C489449   22087     PAPER BUNTING WHITE LACE               -12 2009-12-01 10:33:00      2.95 16321      Australia     \n 2 C489449   85206A    CREAM FELT EASTER EGG BASKET            -6 2009-12-01 10:33:00      1.65 16321      Australia     \n 3 C489449   21895     POTTING SHED SOW 'N' GROW SET           -4 2009-12-01 10:33:00      4.25 16321      Australia     \n 4 C489449   21896     POTTING SHED TWINE                      -6 2009-12-01 10:33:00      2.1  16321      Australia     \n 5 C489449   22083     PAPER CHAIN KIT RETRO SPOT             -12 2009-12-01 10:33:00      2.95 16321      Australia     \n 6 C489449   21871     SAVE THE PLANET MUG                    -12 2009-12-01 10:33:00      1.25 16321      Australia     \n 7 C489449   84946     ANTIQUE SILVER TEA GLASS ETCHED        -12 2009-12-01 10:33:00      1.25 16321      Australia     \n 8 C489449   84970S    HANGING HEART ZINC T-LIGHT HOLDER      -24 2009-12-01 10:33:00      0.85 16321      Australia     \n 9 C489449   22090     PAPER BUNTING RETRO SPOTS              -12 2009-12-01 10:33:00      2.95 16321      Australia     \n10 C489459   90200A    PURPLE SWEETHEART BRACELET              -3 2009-12-01 10:44:00      4.25 17592      United Kingdom\n# ℹ 18,734 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Quantity 음수값 제거\ndf <- df %>% filter(Quantity > 0)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}